# 回测数据选择功能 - 快速开始指南

## ⚡ 快速上手

### 1️⃣ 启动应用
```bash
python app_with_cache.py
```
访问: http://localhost:5000

### 2️⃣ 获取数据（首次使用）
1. 切换到 **"📊 数据管理"** 标签页
2. 选择板块（如：中证500）
3. 设置日期范围（可使用默认值）
4. 输入数量（如：20只）
5. 点击 **"获取数据"**
6. 等待数据下载完成

### 3️⃣ 进行回测

#### 模式A：手动输入股票代码
```
步骤：
  1. 切换到 "🔄 回测" 标签页
  2. 确保选中 "手动输入代码" 单选按钮
  3. 在输入框中输入股票代码，多个用逗号分隔
     例如：000001,600000,000858
  4. 点击 "运行回测"
  5. 查看结果
```

#### 模式B：一键使用全部缓存数据
```
步骤：
  1. 切换到 "🔄 回测" 标签页
  2. 点击 "全部缓存数据" 单选按钮
  3. 输入框会自动隐藏
  4. 点击 "运行回测"（会使用所有 52 只缓存的股票）
  5. 查看结果
```

#### 模式C：按板块选择
```
步骤：
  1. 切换到 "🔄 回测" 标签页
  2. 点击 "按板块选择" 单选按钮
  3. 在板块选择框中勾选想要的板块
     - ☐ 沪深A股
     - ☐ 创业板
     - ☐ 科创板
     - ☐ 深成指
     - ☐ 中证500
  4. 实时显示已选板块的股票总数
  5. 点击 "运行回测"
  6. 查看结果
```

## 🎯 三种模式对比

| 功能 | 手动输入 | 全部数据 | 按板块 |
|------|---------|--------|-------|
| **使用场景** | 精确测试特定股票 | 快速测试所有数据 | 分类测试板块 |
| **操作难度** | ⭐⭐ 中等 | ⭐ 最简单 | ⭐⭐ 中等 |
| **时间消耗** | ⭐ 快 | ⭐⭐⭐ 慢 | ⭐⭐ 中等 |
| **灵活性** | ⭐⭐⭐ 最高 | ⭐ 最低 | ⭐⭐ 中等 |
| **典型用途** | 测试特定股票 | 全面评估 | 行业对比 |

## 📊 实时统计信息

页面顶部显示：
```
📊 已缓存 52 只股票数据  [刷新]
```

- 数字会根据缓存的股票自动更新
- 点击 [刷新] 按钮实时获取最新数据

## 🚀 高级用法

### 技巧1：快速切换模式
```
只需点击不同的单选按钮，UI 会自动切换
• 手动输入 → 显示输入框
• 全部数据 → 隐藏所有输入框
• 按板块 → 显示板块复选框
```

### 技巧2：板块多选
```
创业板 + 科创板：
  ✓ 创业板 (10只)
  ✓ 科创板 (10只)
  结果：20只股票（某些可能重复则去重）
```

### 技巧3：查看选中股票数
```
勾选板块后，下方会显示：
"已选 2 个板块，共 20 只股票"

这可以帮助判断回测数据量
```

## 📈 回测结果说明

| 指标 | 说明 | 举例 |
|------|------|------|
| **交易笔数** | 总共的买卖次数 | 150 |
| **总收益率** | 所有交易的累计收益 | +12.5% |
| **平均收益** | 每笔交易的平均收益 | +0.8% |
| **胜率** | 盈利交易的占比 | 65.3% |

## ⚠️ 常见问题

### Q1: 为什么看不到板块选择框？
**A**: 确保选中了"按板块选择"单选按钮。页面加载时默认是"手动输入代码"模式。

### Q2: 缓存数据为什么是0？
**A**: 需要先在"📊 数据管理"页面获取数据。点击"获取数据"按钮。

### Q3: 可以同时勾选多个板块吗？
**A**: 可以！系统支持多选。会自动计算选中板块的所有股票。

### Q4: 回测时间很长怎么办？
**A**: 这是正常现象，尤其是全部数据模式（52只股票）。请耐心等待。

### Q5: 我想回测100只股票怎么办？
**A**: 在"数据管理"页面获取更多数据。默认是20只，可修改为100。

## 🔄 工作流程示意

```
├─ 首次使用
│  ├─ 获取数据 (数据管理页)
│  └─ 进行回测 (回测页)
│
├─ 日常使用
│  ├─ 选择回测模式
│  ├─ 设置参数
│  ├─ 运行回测
│  └─ 查看结果
│
└─ 高级用法
   ├─ 按板块对比
   ├─ 特定股票测试
   └─ 全数据评估
```

## 📝 检查清单

回测前检查：
- [ ] 应用已启动 (localhost:5000)
- [ ] 已获取缓存数据 (缓存数 > 0)
- [ ] 选择了回测模式（手动/全部/按板块）
- [ ] 输入了正确的数据（代码/板块）
- [ ] 网络连接正常

## 🎓 学习资源

详细文档：
- [实现总结](./IMPLEMENTATION_SUMMARY.md) - 完整的技术文档
- [测试套件](./test_backtest_selection.py) - 运行测试验证功能

## 💡 优化建议

1. **大数据量回测**：考虑先用"按板块"模式对比，再用全部数据模式
2. **特定股票测试**：使用"手动输入"模式，可以准确控制
3. **性能考虑**：回测50+只股票可能需要1-2分钟

## 🆘 需要帮助？

1. 查看浏览器控制台 (F12) 的错误消息
2. 检查后端日志输出
3. 运行测试套件验证功能：`python test_backtest_selection.py`
4. 查看详细的实现文档

---

**祝您使用愉快！🎉**
