# 系统优化方案

## 优化需求

### 1. 数据缓存优化 ✅
**需求**：回测不需要每次更新数据，每日首次运行时更新即可

**现状**：
- DataManager已有缓存机制
- 但每次fetch_and_cache都会强制刷新

**方案**：
- 添加"每日首次更新"检查
- 在数据库中记录最后更新时间
- 同一天内使用缓存，次日首次运行时自动更新

### 2. 印花税配置 ✅
**需求**：印花税默认按千分之1收取（注：不是万2），可配置

**现状**：
- config.py中只有commission_rate和slippage
- 缺少印花税配置

**方案**：
- 添加stamp_tax配置项（默认0.001即千1）
- 修改BacktestEngine考虑印花税
- 仅在卖出时收取印花税

### 3. Web界面策略选择 ✅
**需求**：网页上看不到可选择的策略，需要增加新策略

**现状**：
- API已支持策略选择（/api/strategies）
- 但策略列表不包含新策略
- 前端可能没有策略选择UI

**方案**：
- 将3个新策略集成到config.py的STRATEGY_MAP
- 更新app_with_cache.py导入新策略
- 确保前端HTML有策略选择下拉框
